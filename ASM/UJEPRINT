           GENSAVE CSECT=UJEPRINT
           SPACE 3
* THIS PROGRAM IS USED BY THE JOL 'PRINT' COMMAND.
*
* PREVIOUSLY, IEBGENER WAS USED, BUT UNDER HASP THE RESULT IS NOT
*  VERY ATTRACTIVE. IEBGENER GOES INTO A BLOCK BY BLOCK COPY
*  IF NO DCB IS SPECIFIED ON THE OUTPUT DCB.
*
* THE FILES REQUIRED ARE:-
*    SYSPRINT FOR ANY ERROR MESSAGES
*    INPUT
*    OUT01,OUT02 ETC TO A MAXIMUM OF 5.
*
* WE WILL SEE HOW MANY 'OUTPUT' FILES WE HAVE.
           SR  R4,R4
           DEVTYPE =CL8'OUT02',OUT02
           LTR R15,R15
           BNZ ONE
           DEVTYPE =CL8'OUT03',OUT03
           LTR R15,R15
           BNZ TWO
           DEVTYPE =CL8'OUT04',OUT04
           LTR R15,R15
           BNZ THREE
           DEVTYPE =CL8'OUT05',OUT05
           LTR R15,R15
           BNZ FOUR
ONE        OI  OUT01L,X'80'    SHORTEN OPEN LIST
TWO        OI  OUT02L,X'80'    SHORTEN OPEN LIST
THREE      OI  OUT03L,X'80'    SHORTEN OPEN LIST
FOUR       OI  OUT04L,X'80'    SHORTEN OPEN LIST
FIVE       OI  OUT05L,X'80'    SHORTEN OPEN LIST
           OPEN MF=(E,OPENLIST)
* NOW COMMENCE COPYING MADLY.
COPY       GET INPUT
           PUT OUT01,(1)
           TM  OUT02L,X'80'
           BO  COPY
           PUT OUT02,(1)
           TM  OUT03L,X'80'
           BO  COPY
           PUT OUT03,(1)
           TM  OUT04L,X'80'
           BO  COPY
           PUT OUT04,(1)
           TM  OUT05L,X'80'
           BO  COPY
           PUT OUT05,(1)
           B   COPY
           SPACE 3
EOFINPUT   EQU *
           CLOSE (SYSPRINT,,INPUT,,OUT01,,OUT02,,OUT03,,OUT04,,OUT05)
           FREEPOOL SYSPRINT
           FREEPOOL INPUT
           FREEPOOL OUT01
           TM  OUT02L,X'80'
           BO  RETN
           FREEPOOL OUT02
           TM  OUT03L,X'80'
           BO  RETN
           FREEPOOL OUT03
           TM  OUT04L,X'80'
           BO  RETN
           FREEPOOL OUT04
           TM  OUT05L,X'80'
           BO  RETN
           FREEPOOL OUT05
RETN       GENRETN
DCBEXIT    EQU  *
* R1 -> CURRENT DCB
           LA   R4,INPUT
           USING IHADCB,R4
* COPY DCB FROM INPUT TO OUTPUT DATA SET
           MVC  DCBRECFM(
           DS  0D
OPENLIST   DC  AL1(15),AL3(SYSPRINT)
           DC  AL1(0),AL3(INPUT)
OUT01L     DC  AL1(15),AL3(OUT01)
OUT02L     DC  AL1(15),AL3(OUT02)
OUT03L     DC  AL1(15),AL3(OUT03)
OUT04L     DC  AL1(15),AL3(OUT04)
OUT05L     DC  AL1(15),AL3(OUT05)
           PRINT NOGEN
SYSPRINT   DCB DDNAME=SYSPRINT,RECFM=VB,LRECL=150,BLKSIZE=160,DSORG=PS,*
               MACRF=PM
INPUT DCB DDNAME=INPUT,EODAD=EOFINPUT,MACRF=GL,DSORG=PS,DEVD=DA
OUT01 DCB DDNAME=OUT01,DSORG=PS,DEVD=DA,MACRF=PM,EXLST=FIXDCB
OUT02 DCB DDNAME=OUT02,DSORG=PS,DEVD=DA,MACRF=PM,EXLST=FIXDCB
OUT03 DCB DDNAME=OUT03,DSORG=PS,DEVD=DA,MACRF=PM,EXLST=FIXDCB
OUT04 DCB DDNAME=OUT04,DSORG=PS,DEVD=DA,MACRF=PM,EXLST=FIXDCB
OUT05 DCB DDNAME=OUT05,DSORG=PS,DEVD=DA,MACRF=PM,EXLST=FIXDCB
           PRINT GEN
       DCBD DSORG=PS
FIXDCB   DC X'85',AL3(DCBEXIT)
           PRINT GEN
           LTORG
           END
